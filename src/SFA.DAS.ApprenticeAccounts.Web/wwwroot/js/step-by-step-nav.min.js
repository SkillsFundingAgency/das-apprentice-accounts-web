window.GOVUK=window.GOVUK||{};window.GOVUK.Modules=window.GOVUK.Modules||{},function(n){"use strict";n.AppStepNav=function(){function a(t){function s(){i(!0)}function h(){i(!1)}function a(){i(f())}function i(i){t.toggleClass(l,i);r.toggleClass("js-hidden",!i);o.attr(c,i);t.find(e).html(i?n.hideText:n.showText)}function u(){return t.hasClass(l)}function f(){return!u()}function v(){return r.find(".js-link").length}var o=t.find(".js-step-title-button"),r=t.find(".js-panel");this.title=t.find(".js-step-title-text").text().trim();this.element=t;this.show=s;this.hide=h;this.toggle=a;this.setIsShown=i;this.isShown=u;this.isHidden=f;this.numberOfContentItems=v}function y(n,t,i,f,e){function s(){var n={label:c(),dimension28:t.numberOfContentItems().toString()};f.track("pageElementInteraction",l(),n)}function c(){return`${o.closest(h).attr(u)} - ${t.title} - ${a()}: ${r}${w()}`}function l(){return t.isHidden()?"stepNavHidden":"stepNavShown"}function a(){return v()?p()+" click":y()?"Heading click":"Elsewhere click"}function v(){return o.hasClass("js-toggle-link")}function y(){return o.hasClass("js-step-title-text")}function p(){return t.isHidden()?"Minus":"Plus"}function w(){return e?" ; optional":""}this.track=s;var o=$(n.target)}function p(n,t,i){function u(){var u={label:`${$(n.target).attr("href")} : ${r}`},f=$(n.target).closest(".app-step-nav__list").attr("data-length");f&&(u.dimension28=f);t.track("stepNavLinkClicked",i,u)}this.track=u}function w(){this.track=function(){}}var n={},o=!1,r,f="govuk-step-nav-active-link",t="app-step-nav__list-item--active",s="app-step-nav__step--active",v="#content",h=".js-toggle-panel",e=".js-toggle-link",c="aria-expanded",l="step-is-shown",u="data-position",i;this.start=function(b){function ot(){n.showText=b.attr("data-show-text");n.hideText=b.attr("data-hide-text");n.showAllText=b.attr("data-show-all-text");n.hideAllText=b.attr("data-hide-all-text")}function st(){b.prepend(`<div class="app-step-nav__controls">
            <button aria-expanded="false" class="app-step-nav__button app-step-nav__button--controls js-step-controls-button">${n.showAllText}</button></div>`)}function ht(){ft.each(function(){$(this).find(e).length||$(this).find(".js-step-title-button").append('<span class="app-step-nav__toggle-link js-toggle-link" aria-hidden="true" hidden><\/span>')})}function ct(){var n=b.find(".js-panel").first().attr("id");k=b.find(".js-step-controls-button");k.attr("aria-controls",n)}function lt(n){var t=[];$.each(d,function(){var i=new a($(this));i.setIsShown(n);n&&t.push($(this).attr("id"))});n?nt(i,JSON.stringify(t)):bt(i)}function at(){var n=tt(i)||[];$.each(d,function(){var i=$(this).attr("id"),t=new a($(this));o&&n.indexOf(i)>-1||typeof $(this).attr("data-show")!="undefined"?t.setIsShown(!0):t.setIsShown(!1)});n.length>0&&(k.attr(c,!0),it())}function vt(){$.each(d,function(){var n=$(this),t=n.find(".js-step-title"),i=n.find(".js-panel").first().attr("id");t.wrapInner('<span class="js-step-title-text"><\/span>');t.wrapInner(`<button class="app-step-nav__button app-step-nav__button--title js-step-title-button" aria-expanded="false" aria-controls="${i}"></button>`)})}function yt(n){b.find(h).click(function(t){var i=$(this).closest(".js-step"),r=new a(i),u,f;r.toggle();u=typeof i.data("optional")!="undefined";f=new y(t,r,d,n,u);f.track();it();pt(i)})}function pt(n){var r;if(o){var t=JSON.parse(tt(i))||[],u=n.attr("id"),f=n.hasClass(l);f?t.push(u):(r=t.indexOf(u),r>-1&&t.splice(r,1));nt(i,JSON.stringify(t))}}function wt(n){b.find(".js-link").click(function(t){var r=new p(t,n,$(this).attr(u)),i;r.track();i=$(this).attr("href");$(this).attr("rel")!=="external"&&nt(f,$(this).attr(u));i===v&&(kt($(this)),ut())})}function nt(n,t){window.sessionStorage.setItem(n,t)}function tt(n){return window.sessionStorage.getItem(n)}function bt(n){window.sessionStorage.removeItem(n)}function kt(n){b.find("."+t).removeClass(t);n.parent().addClass(t)}function dt(){var i=b.find(".js-list-item."+t),n;i.length<=1||(n=tt(f)||b.find("."+t).first().attr(u),b.find(`.js-link[data-position="${n}"]`).parent().hasClass(t)||(n=b.find("."+t).first().find(".js-link").attr(u)),gt(i,n),ut())}function gt(n,i){n.each(function(){$(this).find(".js-link").attr(u).toString()!==i.toString()&&($(this).removeClass(t),$(this).find(".visuallyhidden").remove())})}function ut(){b.find("."+s).removeClass(s).removeAttr("data-show");b.find("."+t).closest(".app-step-nav__step").addClass(s).attr("data-show","")}function ni(t){k=b.find(".js-step-controls-button");k.on("click",function(){var i;return k.text()===n.showAllText?(k.text(n.hideAllText),b.find(e).html(n.hideText),i=!0,t.track("pageElementInteraction","stepNavAllShown",{label:`${n.showAllText}: ${r}`})):(k.text(n.showAllText),b.find(e).html(n.showText),i=!1,t.track("pageElementInteraction","stepNavAllHidden",{label:`${n.hideAllText}: ${r}`})),lt(i),k.attr(c,i),it(),!1})}function it(){var t=b.find(".step-is-shown").length;t===rt?k.text(n.hideAllText):k.text(n.showAllText)}var g;b.addClass("app-step-nav--active");b.removeClass("js-hidden");r=b.hasClass("app-step-nav--large")?"Big":"Small";o=!!b.filter("[data-remember]").length&&r==="Big";var d=b.find(".js-step"),ft=b.find(h),rt=b.find(".js-panel").length,et=b.find("app-step-nav__link").length,k;i=b.data("id")||!1;i&&(f=`${f}_${i}`);g=new w(rt,et,i);ot();vt();st();ht();ct();dt();at();yt(g);ni(g);wt(g)}}}(window.GOVUK.Modules);